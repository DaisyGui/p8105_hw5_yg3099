---
title: "p8105_hw5_yg3099"
author: "daisy_gui"
date: "2025-11-16"
output: github_document
---
```{r}
library(tidyverse)
```


## Problem 1

In this function, random birthdays can be created and tell if there are duplicated ones. 

```{r}
set.seed(1)

birthday_dup = function(n_people, n_days = 365) {
  birthdays = sample(1:n_days, size = n_people, replace = TRUE)
  any(duplicated(birthdays))
}

```

Now, stimulate 10,000 times for sample size 2~50 and calculate the probability of occurring duplicated birthdays. Results are stored in sim_results_df. 

```{r}

sim_results_df = 
  expand_grid(
    group_size = 2:50,
    iter = 1:10000
  ) |> 
  mutate(
    dup = map_lgl(group_size, birthday_dup)
  ) |> 
  group_by(group_size) |> 
  summarize(
    prob_dup = mean(dup)
  )
```

The graph below shows the change in probability with group size from 2 to 50. 

```{r}
sim_results_df |> 
  ggplot(aes(x = group_size, y = prob_dup)) +
  geom_line() +
  geom_point() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.01)) +
  labs(
    x = "Group size",
    y = "Probability of at least two share a birthday",
    title = "Probability of shared a birthday with different group sizes"
  )
```

According to the plot, the probability of at least two people sharing a birthday increases rapidly as the group size grows from 2. When the group size is around 23-24, the probability rises to about 50%. The rate of increase then slow down when the group size increase. The probability reaches 97.20% at group size n = 50. Overall, the probability of at least two people sharing a birthday get closer and closer to 100% as the group size grows. 

