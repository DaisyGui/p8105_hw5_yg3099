p8105_hw5_yg3099
================
daisy_gui
2025-11-16

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(broom)
```

## Problem 1

In this function, random birthdays can be created and tell if there are
duplicated ones.

``` r
set.seed(1)

birthday_dup = function(n_people, n_days = 365) {
  birthdays = sample(1:n_days, size = n_people, replace = TRUE)
  
  any(duplicated(birthdays))
}
```

Now, stimulate 10,000 times for sample size 2~50 and calculate the
probability of occurring duplicated birthdays. Results are stored in
sim_results_df.

``` r
bd_prob_df = 
  expand_grid(
    group_size = 2:50,
    iter = 1:10000
  ) |> 
  mutate(
    dup = map_lgl(group_size, birthday_dup)
  ) |> 
  group_by(group_size) |> 
  summarize(
    prob_dup = mean(dup)
  )
```

The graph below shows the change in probability with group size from 2
to 50.

``` r
bd_prob_df |> 
  ggplot(aes(x = group_size, y = prob_dup)) +
  geom_line() +
  geom_point() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.01)) +
  labs(
    x = "Group size",
    y = "Probability of at least two share a birthday",
    title = "Probability of shared a birthday with different group sizes"
  )
```

![](p8105_hw5_yg3099_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

According to the plot, the probability of at least two people sharing a
birthday increases rapidly as the group size grows from 2. When the
group size is around 23-24, the probability rises to about 50%. The rate
of increase then slow down when the group size increase. The probability
reaches 97.20% at group size n = 50. Overall, the probability of at
least two people sharing a birthday get closer and closer to 100% as the
group size grows.

## Problem 2

First, a function is written to generate one random sample and return
$\mu$ and p-value.

``` r
t_sample = function(n = 30, mu, sigma = 5) {
  x = rnorm(n, mean = mu, sd = sigma)
  
  test_res = t.test(x, mu = 0) |> tidy()
  
  tibble(
    mu_hat = mean(x),
    p_value = test_res$p.value
  )
}
```

Then do 5,000 stimulations with the function for $\mu = 0$ to $\mu = 6$.

``` r
t_result_df = 
  expand_grid(
    true_mu = 0:6,
    iter = 1:5000
  ) |> 
  mutate(
    estimate_df = map(true_mu, 
                      \(m) t_sample(mu = m))
  ) |> 
  unnest(estimate_df)
```

``` r
t_result_df
```

    ## # A tibble: 35,000 × 4
    ##    true_mu  iter  mu_hat p_value
    ##      <int> <int>   <dbl>   <dbl>
    ##  1       0     1 -1.62    0.0545
    ##  2       0     2 -0.542   0.569 
    ##  3       0     3 -0.278   0.767 
    ##  4       0     4 -0.303   0.733 
    ##  5       0     5  0.406   0.637 
    ##  6       0     6  0.147   0.881 
    ##  7       0     7  1.20    0.191 
    ##  8       0     8 -0.0542  0.957 
    ##  9       0     9 -0.119   0.878 
    ## 10       0    10 -1.89    0.0712
    ## # ℹ 34,990 more rows

Here’s the plot showing the proportion that h0 was rejected and the true
value of $\mu$.

``` r
pw_df = 
  t_result_df |> 
  mutate(reject = p_value < 0.05) |> 
  group_by(true_mu) |> 
  summarize(power = mean(reject))

pw_df |> 
  ggplot(aes(x = true_mu, y = power)) +
  geom_line() +
  geom_point() +
  labs(
    x = "True mu",
    y = "Power of test",
    title = "Power of test with true value of mu"
  )
```

![](p8105_hw5_yg3099_files/figure-gfm/unnamed-chunk-8-1.png)<!-- -->
